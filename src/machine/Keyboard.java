/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package machine;

import java.awt.event.KeyEvent;;
import java.awt.event.KeyListener;

/**
 *
 * @author admin
 */
public final class Keyboard implements KeyListener {
    
    private int key;
    private boolean pressed;
    private int[][] mapakl = {
/*              { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127}, */
/* 0 bez  */    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,60,94,34,35,36,37,38,39,40,41,58,59,60,61,62,63,64,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127},
/* 1 SH   */    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,60,94,34,35,36,37,38,39,40,41,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127},
/* 2 Ctrl */    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,126,220,221,222,223,224,225,226,227,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127},
/* 3 Sh+Ct*/    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,94,208,209,210,211,212,213,214,215,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127},
/* 4 AK   */    { 32,6,21,4,1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,6,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,128,129,130,131,132,133,134,135,136,137,138,123,124,125,126,127},
/* 5 AK+SH*/    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,160,161,162,163,164,165,166,167,168,169,170,123,124,125,126,127},
/* 6 AK+Ct*/    { 32,6,21,4,1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,6,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,144,145,146,147,148,149,150,151,152,153,154,123,124,125,126,127},
/* 7 AK+SH+Ct*/ { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,176,177,178,179,180,181,182,183,184,185,186,122,123,124,125,126,127},
/* 8 nump */    { 32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,48,49,50,51,52,53,54,55,56,57,58,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127},
                          };
    
    public void reset() {
        pressed = false;
        key = 0;
    }

    public int isKey() {
        return pressed ? 1 : 0;
    }
    
    public int getKey() {
        pressed = false;
//        System.out.println(String.format("key: %04X", key));
        return key;
    }
    
    @Override
    public void keyTyped(KeyEvent ke) {
 
    }

    @Override
    public void keyPressed(KeyEvent ke) {
        int kodkl,ma;
        boolean isact,shift;

        kodkl = ke.getKeyCode(); // isact=ke.isActionKey();
        
        if ((kodkl == 16)||(kodkl == 17)||(kodkl == 18)) shift=true; else shift=false;
        ma=0;
        if (ke.isActionKey()) ma=4;;
        if (ke.isShiftDown()) ma=ma+1;
        if (ke.isControlDown()) ma=ma+2;
        if (ke.getKeyLocation()== KeyEvent.KEY_LOCATION_NUMPAD) ma=8;

//        System.out.println(String.format("key: %04X  mapa: %02X", kodkl,ma));
        
        if (!shift){
            if ((kodkl>31)&&(kodkl<128)) key = mapakl[ma][kodkl-32];
            else {
                   switch(kodkl) {
                       case 8: key =8; break;    // BackSpace
                       case 9: key =9; break;    // TAB
                       case 10: key =13; break;  // Enter (Vezmi)
                       case 129: key =62; break; // ´ (>) - vedle rovná se na české klávesnici
                       default: key = 32;        // space key
                                 };
                 };
            
            pressed = true;
        }
        else {pressed = false;
              ke.consume();
             };
    }

    @Override
    public void keyReleased(KeyEvent ke) {
        switch(ke.getKeyCode()) {
            
        }  //switch
    }

}